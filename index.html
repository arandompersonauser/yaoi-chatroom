 <!DOCTYPE html>
<html>
<head>
  <title>yaoi chatroom</title>
  <meta charset="UTF-8">
  <style>
    body { font-family:sans-serif; background:#f5f5f5; }
    #messages { max-width: 400px; margin:20px auto; background:white; border-radius:8px; padding:10px; height:300px; overflow-y:auto; }
    .msg { display: flex; align-items: center; margin-bottom: 8px; }
    .pfp { width: 28px; height: 28px; border-radius: 50%; margin-right: 7px; object-fit: cover; }
    .name { font-weight: bold; margin-right: 3px; }
    #inputRow { max-width: 400px; margin:0 auto; display: flex; background:white; border-radius:8px; padding:10px; }
    #msgInput { flex:1; margin-right:5px; }
  </style>
  <!-- Add Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
</head>
<body>
  <div style="max-width:400px;margin:40px auto">
    <h2>join</h2>
    <input id="nameInput" placeholder="enter your name" /><br><br>
    <input id="pfpInput" placeholder="profile picture URL (optional)" /><br><br>
    <button id="joinBtn">Join</button>
  </div>
  <div id="chatArea" style="display:none">
    <div id="messages"></div>
    <div id="inputRow">
      <input id="msgInput" placeholder="Type a message..." />
      <button id="sendBtn">send</button>
    </div>
  </div>
  <script>
    // Firebase config (get yours from Firebase Console)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // DOM
    const nameInput = document.getElementById('nameInput');
    const pfpInput = document.getElementById('pfpInput');
    const joinBtn = document.getElementById('joinBtn');
    const chatArea = document.getElementById('chatArea');
    const messagesDiv = document.getElementById('messages');
    const msgInput = document.getElementById('msgInput');
    const sendBtn = document.getElementById('sendBtn');

    let myName = '', myPfp = '';

    joinBtn.onclick = () => {
      myName = nameInput.value.trim() || 'Anonymous';
      myPfp = pfpInput.value.trim();
      document.querySelector('div[style*="max-width:400px"]').style.display = 'none';
      chatArea.style.display = '';
    };

    sendBtn.onclick = sendMsg;
    msgInput.onkeydown = (e) => { if (e.key === 'Enter') sendMsg(); };

    function sendMsg() {
      const text = msgInput.value.trim();
      if (!text) return;
      db.ref('chatroom').push({
        name: myName,
        pfp: myPfp,
        text,
        ts: Date.now()
      });
      msgInput.value = '';
    }

    db.ref('chatroom').limitToLast(40).on('child_added', snap => {
      const msg = snap.val();
      const div = document.createElement('div');
      div.className = 'msg';
      if (msg.pfp) {
        const img = document.createElement('img');
        img.src = msg.pfp;
        img.className = 'pfp';
        div.appendChild(img);
      }
      const spanName = document.createElement('span');
      spanName.className = 'name';
      spanName.textContent = msg.name + ': ';
      div.appendChild(spanName);
      const spanText = document.createElement('span');
      spanText.textContent = msg.text;
      div.appendChild(spanText);
      messagesDiv.appendChild(div);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    });
  </script>
</body>
</html>